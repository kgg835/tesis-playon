<ui:composition template="template/template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<ui:param name="panelTitle"
		value="Listado de Playas de Estacionamiento" />

	<ui:define name="panelContent" class="admin-font">
		<p:growl id="messages" />

		<p>Seleccione el período a liquidar y luego las playas que desea
			liquidar.</p>

		<table class="ui-datatable liquidacion-table">
			<tr>
				<th colspan="2" class="ui-widget-header ui-state-default"
					scope="col">Período a liquidar</th>
			</tr>
			<tr>
				<td style="text-align: right;" class="ui-widget-content"><h:outputText
						value="Desde:" /></td>
				<td class="ui-widget-content"><p:calendar
						value="#{liquidacionMB.fechaDesde}" id="calDesde" /></td>
			</tr>
			<tr>
				<td style="text-align: right;" class="ui-widget-content"><h:outputText
						value="Hasta:" /></td>
				<td class="ui-widget-content"><p:calendar
						value="#{liquidacionMB.fechaHasta}" id="calHasta" /></td>
			</tr>
			<tr>
				<td colspan="2" style="text-align: right;" class="ui-widget-content"><p:commandButton
						id="buscarButton" value="Buscar" icon="ui-icon-search"
						action="#{liquidacionMB.updatePlayasALiquidar}" ajax="true"
						update="playas" /></td>
			</tr>
		</table>

		<br />
		<p:dataTable id="playas" var="playa"
			value="#{liquidacionMB.playasALiquidarList}"
			filteredValue="#{liquidacionMB.filteredPlayas}"
			widgetVar="playasTable" paginatorPosition="bottom" paginator="true"
			rows="20" emptyMessage="No existen playas para liquidar"
			selection="#{liquidacionMB.playasSeleccionadas}">

			<f:facet name="header">  
            		Listado de transacciones Playas con transacciones  
        		</f:facet>

			<p:column headerText="Razon Social" styleClass="column-font"
				filterBy="#{playa.razonSocial}" filterMatchMode="contains">
				<h:outputText value="#{playa.razonSocial}" />
			</p:column>

			<p:column headerText="C.U.I.T." styleClass="column-font"
				filterBy="#{playa.cuit}" filterMatchMode="contains">
				<h:outputText value="#{playa.cuit}" />
			</p:column>

			<p:column headerText="Transacciones" styleClass="column-font"
				filterBy="#{liquidacionMB.cantTransacciones(playa.id)}"
				filterMatchMode="contains">
				<h:outputText value="#{liquidacionMB.cantTransacciones(playa.id)}" />
			</p:column>

			<p:column headerText="Importe Total" styleClass="column-font"
				filterBy="#{liquidacionMB.importeTotal(playa.id)}"
				filterMatchMode="contains">
				<h:outputText value="$ #{liquidacionMB.importeTotal(playa.id)}" />
			</p:column>

			<p:column headerText="Opciones" styleClass="column-options"
				style="text-align:center; width:95px;">

				<p:commandLink id="view" update=":mainForm:displayView"
					oncomplete="playasDialog.show();" title="Ver Datos">
					<f:setPropertyActionListener value="#{playa}"
						target="#{playaMB.playaSelected}" />
					<h:graphicImage library="images/icons" name="search.png" />
				</p:commandLink>

			</p:column>

			<f:facet name="footer">
				<h:panelGroup id="removeFilter" layout="block"
					style="text-align: right;">
					<p:commandLink id="quitarFiltro" value="Quitar Filtro"
						action="/admin/liquidacionplayas.html?faces-redirect=true"
						ajax="false" />
				</h:panelGroup>
				<!--<p:commandButton id="multiViewButton" value="View" -->
				<!--icon="ui-icon-search" update=":mainForm:displayMulti" -->
				<!--oncomplete="multiPlayasDialog.show()" /> -->
			</f:facet>
		</p:dataTable>
		<div align="right">
			<p>
				<p:commandButton id="liquidacionButton" value="Liquidar"
					icon="ui-icon-circle-arrow-e" action="#{liquidacionMB.liquidar}"
					ajax="false" />
			</p>
		</div>

		<!-- DIALOG PARA VER LOS DATOS DE LA PLAYA SELECCIONADA -->
		<p:dialog header="Datos de la Playa" widgetVar="playasDialog"
			resizable="false" id="playasDlg" showEffect="fade" modal="true"
			draggable="false">

			<h:panelGrid id="displayView" columns="2" cellpadding="8"
				style="margin:0 auto;">

				<p:column>
					<h:outputText value="Razon Social: " />
				</p:column>
				<p:column>
					<h:outputText value="#{playaMB.playaSelected.razonSocial}"
						style="font-weight:bold" />
				</p:column>

				<p:column>
					<h:outputText value="Nombre Comercial: " />
				</p:column>
				<p:column>
					<h:outputText value="#{playaMB.playaSelected.nombreComercial}"
						style="font-weight:bold" />
				</p:column>

				<p:column>
					<h:outputText value="C.U.I.T.: " />
				</p:column>
				<p:column>
					<h:outputText value="#{playaMB.playaSelected.cuit}"
						style="font-weight:bold" />
				</p:column>

				<p:column>
					<h:outputText value="Barrio: " />
				</p:column>
				<p:column>
					<h:outputText value="#{playaMB.playaSelected.barrio.nombre}"
						style="font-weight:bold" />
				</p:column>

				<p:column>
					<h:outputText value="Domicilio: " />
				</p:column>
				<p:column>
					<h:outputText value="#{playaMB.playaSelected.domicilio}"
						style="font-weight:bold" />
				</p:column>

				<p:column>
					<h:outputText value="Teléfono: " />
				</p:column>
				<p:column>
					<h:outputText value="#{playaMB.playaSelected.telefono}"
						style="font-weight:bold" />
				</p:column>

				<p:column>
					<h:outputText value="E-mail: " />
				</p:column>
				<p:column>
					<h:outputText value="#{playaMB.playaSelected.email}"
						style="font-weight:bold" />
				</p:column>

				<p:column>
					<h:outputText value="Disponibilidad: " />
				</p:column>
				<p:column>
					<h:outputText value="#{playaMB.playaSelected.disponibilidad}"
						style="font-weight:bold" />
				</p:column>

				<p:column>
					<h:outputText value="Estado: " />
				</p:column>
				<p:column>
					<h:outputText value="#{playaMB.playaSelected.estado.nombre}"
						style="font-weight:bold" />
				</p:column>

				<p:column>
				</p:column>

				<p:column style="text-align:right">
					<div align="right">
						<p:commandButton id="btnAceptar" value="Aceptar"
							onclick="playasDialog.hide()" type="button" />
					</div>
				</p:column>

			</h:panelGrid>
		</p:dialog>

		<p:dialog id="multiDialog" header="Playas Seleccionadas"
			widgetVar="multiPlayasDialog" height="300" showEffect="fade"
			hideEffect="explode">

			<p:dataList id="displayMulti"
				value="#{liquidacionMB.playasSeleccionadas}" var="playaSeleccionada">  
            		Playa: #{playaSeleccionada.razonSocial}, C.U.I.T.: #{playaSeleccionada.cuit}  
        		</p:dataList>

		</p:dialog>
	</ui:define>
</ui:composition>